# 3x-ui Agent Environment Configuration
# Copy this file to /etc/x-ui-agent/agent.env and customize

# ========================================
# Server Identification
# ========================================

# Unique identifier for this agent (used in logs and metrics)
AGENT_SERVER_ID=vpn-us-1

# Human-readable server name
AGENT_SERVER_NAME=VPN US East

# Comma-separated tags for filtering/grouping
AGENT_TAGS=us,production,east-coast

# ========================================
# Network Settings
# ========================================

# Address and port for agent API to listen on
# WARNING: Only controller should access this port!
AGENT_LISTEN_ADDR=0.0.0.0:2054

# Controller endpoint (for future agent-initiated connections)
AGENT_CONTROLLER_ENDPOINT=https://panel.example.com:2053

# ========================================
# Authentication
# ========================================

# Auth type: "mtls" (recommended) or "jwt"
AGENT_AUTH_TYPE=mtls

# mTLS Certificate Paths
AGENT_CERT_FILE=/etc/x-ui-agent/certs/agent.crt
AGENT_KEY_FILE=/etc/x-ui-agent/certs/agent.key
AGENT_CA_FILE=/etc/x-ui-agent/certs/ca.crt

# JWT Secret (only if AGENT_AUTH_TYPE=jwt)
# AGENT_JWT_SECRET=change-me-to-a-strong-secret

# ========================================
# Xray Configuration
# ========================================

# Path to Xray binary directory
XRAY_BIN_FOLDER=/usr/local/x-ui/bin

# Path to Xray configuration directory
XRAY_CONFIG_FOLDER=/etc/x-ui

# ========================================
# Logging
# ========================================

# Log level: debug, info, notice, warning, error
AGENT_LOG_LEVEL=info

# Log file path
AGENT_LOG_FILE=/var/log/x-ui-agent/agent.log

# ========================================
# Performance Tuning
# ========================================

# Maximum concurrent requests to process
AGENT_MAX_CONCURRENT=50

# Request timeout in seconds
AGENT_REQUEST_TIMEOUT=30

# Rate limit: requests per minute per IP
AGENT_RATE_LIMIT=100

# ========================================
# Security
# ========================================

# Maximum request body size (in bytes)
# Default: 10MB
# AGENT_MAX_BODY_SIZE=10485760

# ========================================
# Notes
# ========================================

# 1. After editing this file, restart the agent:
#    systemctl restart x-ui-agent
#
# 2. View logs:
#    journalctl -u x-ui-agent -f
#
# 3. Test health endpoint:
#    curl -k https://localhost:2054/api/v1/health
#
# 4. Firewall configuration:
#    - Open port 2054 ONLY for controller IP
#    - Block all other access to prevent unauthorized control
#
# 5. Certificate management:
#    - Keep private key (agent.key) secure (chmod 600)
#    - Rotate certificates regularly
#    - Revoke compromised certificates immediately
